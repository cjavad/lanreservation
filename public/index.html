<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="lib.js"></script>
    <script>
        let taken_seats = [];

        window.onload = function () {
            setInputFilter(document.getElementById("seat"), function (value) {
                return /^\d{0,2}$/.test(value); // Allow digits using a RegExp and > 70
            });

            function checkIfAvailable () {
                const val = [document.getElementById("letter").value, document.getElementById("number").value];
                for (let i = 0; i < taken_seats.length; i++) {
                    if (taken_seats[i][0] === val[0] && taken_seats[i][1] === val[1]) {
                        return false;
                    }
                }
                return true;
            }

            var id = getParameterByName('id');
            document.getElementById('id').value = id;

            getJSON('/get_all_seatings',
                function (err, data) {
                    if (err !== null) {
                        console.log('Something went wrong: ' + err);
                    } else {
                        data.forEach(elm => {
                            if (elm.seat !== null) {
                                taken_seats.push(elm);
                                document.getElementById("takenseats").appendChild(document.createTextNode(elm.letter + elm.seat + " "));
                            }
                        });
                    }
                });
        }
    </script>
</head>

<body>
    <image src="floor1.png"></image>
    <div id="takenseats">
        <a><b>Taget pladser: </b></a>
    </div>
    <form action="/update_seating" method="POST">
        <label for="id">ID:</label>
        <input type="text" id="id" name="id"><br><br>
        <label for="letter">Sæde bogstav</label>
        <select id="letter" name="letter">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
        </select>
        <label for="number">Sæde nummer:</label>
        <input type="text" id="seat" name="seat"><br><br>
        <input type="submit" value="Submit">
    </form>
</body>

</html>